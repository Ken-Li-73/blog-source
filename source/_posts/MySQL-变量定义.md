---
title: 'MySQL:变量定义'
abbrlink: a82b342a
date: 2022-03-12 15:33:32
tags:
---

学习笔记：介绍MySQL中变量的定义和使用。

<!--more-->

	系统变量:
		全局变量
			作用域:服务器每次启动将为所有的全局变量赋初始值，针对于所有的会话（连接）有效，但不能跨重启；如果要保证重启不变，则需要修改配置文件；
		会话变量
			作用域：仅仅针对当前连接有效
	自定义变量:
		用户变量
		局部变量

### 1.系统变量
#### 1.1 系统变量定义
	说明:变量由系统提供，不是用户定义，属于服务器层面使用的语法；
	查看全局变量需要关键字 global ，查看会话变量需要关键字 session 或者不写。
#### 1.2 查看
```sql
-- 1.查看所有系统变量
SHOW GLOBAL VARIABLES;  -- 查看所有全局变量
SHOW [SESSION] VARIABLES; -- 查看所有会话变量
```
```sql
-- 2.查看满足条件的部分系统变量
SHOW GLOBAL|SESSION VARIABLES like '%char%'; --查看字符相关的变量
```
```sql
-- 3.查看指定的某个系统变量的值
select @@global.系统变量名; -- 查看全局变量的
select @@系统变量名; -- 查看会话变量
```
```mysql
-- 4.为某个系统变量赋值
set global 系统变量名 = 值;  -- 方式一
set [session] 系统变量名 = 值;  -- 方式一
set @@global.系统变量名 = 值;  -- 方式二
set @@session.系统变量名 = 值;  -- 方式二
```
### 2.自定义变量
说明:变量是用户自定义的，不是由系统定义的
使用步骤:声明、赋值、使用(查看、比较、运算等)

#### 2.1 用户变量
```mysql
-- 作用域:针对于当前会话(连接)有效，同于会话变量的作用域
-- 1.声明并初始化
set @用户变量名 = 值；      -- 方式一
set @用户变量名 := 值；     -- 方式二
select @用户变量名 := 值；  -- 方式三
```
```mysql
-- 2.赋值
-- 通过set和select
set @用户变量名 = 值；      -- 方式一
set @用户变量名 := 值；     -- 方式二
select @用户变量名 := 值；  -- 方式三
-- 通过select into
select 字段名 into 变量名 from 表；
```
```sql
-- 3.使用
select @变量名   -- 查看

-- 例子
set @count = 1;  -- 声明并初始化
select COUNT(*) into @count from employees;  -- 赋值
select @count;  -- 查看
```

#### 2.2 局部变量
```sql
-- 作用域：仅仅在定义它的begin end中有效，应用在begin end中的第一句话！！！
-- 1.声明
DECLARE 变量名 类型;
DECLARE 变量名 类型 DEFAULT 值;
-- 2.赋值
-- 方式一:通过SET或SELECT
SET 局部变量名 = 值;
SET 局部变量名 := 值;
SELECT@局部变量名:=值;
-- 方式二:通过SELECT INTO
SELECT 字段 INTO 局部变量名 FROM 表;
-- 3.使用
SELECT 局部变量名;
```
#### 2.3对比用户变量和局部变量:

| |用户变量|局部变量|
|:-:|:-:|:-:|
|作用域|当前会话|BEGIN END中|
|定义和使用的位置|会话中的任何地方|只能在BEGIN END中，且为第一句话|
|语法|必须加@符号，不用限定类型|一般不用加@符号，需要限定类型|
